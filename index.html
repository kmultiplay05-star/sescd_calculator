<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SES-CD / MM-SES-CD 計算アプリ | 音声入力対応</title>
    <meta name="description" content="クローン病の内視鏡スコア（SES-CD、MM-SES-CD）を音声入力で簡単に計算できるアプリです。">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
                        </svg>
                    </div>
                    <div class="logo-text">
                        <h1>SES-CD / MM-SES-CD</h1>
                        <p>内視鏡スコア計算アプリ</p>
                    </div>
                </div>
                <div class="header-actions">
                    <div class="voice-status" id="voiceStatus">
                        <span class="status-dot"></span>
                        <span class="status-text">音声入力準備完了</span>
                    </div>
                    <button class="reset-btn" id="resetBtn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
                            <path d="M3 3v5h5" />
                        </svg>
                        リセット
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Instructions -->
            <section class="instructions-card">
                <div class="instructions-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <path d="M12 16v-4" />
                        <path d="M12 8h.01" />
                    </svg>
                    <h2>使い方</h2>
                </div>
                <div class="instructions-content">
                    <p>各項目の<strong>0〜3のボタン</strong>をタップしてスコアを選択してください。</p>
                    <p><strong>マイクボタン</strong>で音声入力も可能です。</p>
                </div>
            </section>

            <!-- Score Input Section - All Segments List -->
            <section class="score-section">
                <h2 class="section-title">スコア入力</h2>

                <!-- Score Header Row -->
                <div class="score-header-row">
                    <div class="header-segment">部位</div>
                    <div class="header-item">潰瘍サイズ</div>
                    <div class="header-item">潰瘍面積</div>
                    <div class="header-item">病変面積</div>
                    <div class="header-item">狭窄</div>
                    <div class="header-subtotal">小計</div>
                </div>

                <!-- Ileum -->
                <div class="segment-row" data-segment="ileum">
                    <div class="segment-name">
                        <span class="segment-icon" style="background: var(--color-ileum);">I</span>
                        <span class="segment-label">回腸</span>
                        <button class="voice-btn-mini" data-segment="ileum" title="音声入力">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z" />
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                                <line x1="12" x2="12" y1="19" y2="22" />
                            </svg>
                        </button>
                    </div>
                    <div class="score-buttons" data-segment="ileum" data-variable="ulcer-size">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="ileum" data-variable="ulcer-surface">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="ileum" data-variable="affected-surface">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="ileum" data-variable="stenosis">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="segment-subtotal">
                        <span id="subtotal-ileum">0</span>
                    </div>
                </div>

                <!-- Right Colon -->
                <div class="segment-row" data-segment="right-colon">
                    <div class="segment-name">
                        <span class="segment-icon" style="background: var(--color-right-colon);">R</span>
                        <span class="segment-label">右結腸</span>
                        <button class="voice-btn-mini" data-segment="right-colon" title="音声入力">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z" />
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                                <line x1="12" x2="12" y1="19" y2="22" />
                            </svg>
                        </button>
                    </div>
                    <div class="score-buttons" data-segment="right-colon" data-variable="ulcer-size">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="right-colon" data-variable="ulcer-surface">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="right-colon" data-variable="affected-surface">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="right-colon" data-variable="stenosis">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="segment-subtotal">
                        <span id="subtotal-right-colon">0</span>
                    </div>
                </div>

                <!-- Transverse Colon -->
                <div class="segment-row" data-segment="transverse">
                    <div class="segment-name">
                        <span class="segment-icon" style="background: var(--color-transverse);">T</span>
                        <span class="segment-label">横行結腸</span>
                        <button class="voice-btn-mini" data-segment="transverse" title="音声入力">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z" />
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                                <line x1="12" x2="12" y1="19" y2="22" />
                            </svg>
                        </button>
                    </div>
                    <div class="score-buttons" data-segment="transverse" data-variable="ulcer-size">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="transverse" data-variable="ulcer-surface">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="transverse" data-variable="affected-surface">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="transverse" data-variable="stenosis">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="segment-subtotal">
                        <span id="subtotal-transverse">0</span>
                    </div>
                </div>

                <!-- Left Colon -->
                <div class="segment-row" data-segment="left-colon">
                    <div class="segment-name">
                        <span class="segment-icon" style="background: var(--color-left-colon);">L</span>
                        <span class="segment-label">左結腸</span>
                        <button class="voice-btn-mini" data-segment="left-colon" title="音声入力">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z" />
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                                <line x1="12" x2="12" y1="19" y2="22" />
                            </svg>
                        </button>
                    </div>
                    <div class="score-buttons" data-segment="left-colon" data-variable="ulcer-size">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="left-colon" data-variable="ulcer-surface">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="left-colon" data-variable="affected-surface">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="left-colon" data-variable="stenosis">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="segment-subtotal">
                        <span id="subtotal-left-colon">0</span>
                    </div>
                </div>

                <!-- Rectum -->
                <div class="segment-row" data-segment="rectum">
                    <div class="segment-name">
                        <span class="segment-icon" style="background: var(--color-rectum);">Re</span>
                        <span class="segment-label">直腸</span>
                        <button class="voice-btn-mini" data-segment="rectum" title="音声入力">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z" />
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                                <line x1="12" x2="12" y1="19" y2="22" />
                            </svg>
                        </button>
                    </div>
                    <div class="score-buttons" data-segment="rectum" data-variable="ulcer-size">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="rectum" data-variable="ulcer-surface">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="rectum" data-variable="affected-surface">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="score-buttons" data-segment="rectum" data-variable="stenosis">
                        <button class="score-btn" data-value="0">0</button>
                        <button class="score-btn" data-value="1">1</button>
                        <button class="score-btn" data-value="2">2</button>
                        <button class="score-btn" data-value="3">3</button>
                    </div>
                    <div class="segment-subtotal">
                        <span id="subtotal-rectum">0</span>
                    </div>
                </div>
            </section>

            <!-- Results Section -->
            <section class="results-section" id="resultsSection">
                <h2 class="section-title">計算結果</h2>

                <div class="results-grid">
                    <!-- SES-CD Result -->
                    <div class="result-card ses-cd">
                        <div class="result-header">
                            <h3>SES-CD</h3>
                            <span class="result-badge">Simple Endoscopic Score</span>
                        </div>
                        <div class="result-body">
                            <div class="result-score">
                                <span class="score-number" id="sescdScore">0</span>
                                <span class="score-max">/ 60</span>
                            </div>
                            <div class="severity-indicator" id="sescdSeverity">
                                <span class="severity-label">重症度:</span>
                                <span class="severity-value">-</span>
                            </div>
                            <div class="severity-bar">
                                <div class="severity-fill" id="sescdBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- MM-SES-CD Result -->
                    <div class="result-card mm-ses-cd">
                        <div class="result-header">
                            <h3>MM-SES-CD</h3>
                            <span class="result-badge">Modified Multiplied（重み付け）</span>
                        </div>
                        <div class="result-body">
                            <div class="result-score">
                                <span class="score-number" id="mmsescdScore">0</span>
                            </div>
                            <div class="severity-indicator" id="mmsescdRemission">
                                <span class="severity-label">判定:</span>
                                <span class="severity-value" id="mmsescdStatus">Endoscopic Remission</span>
                            </div>
                            <div class="mm-remission-threshold">
                                <span class="threshold-info">※ Endoscopic Remission: &lt; 22.5</span>
                            </div>
                            <div class="severity-indicator secondary" id="mmsescdSeverity">
                                <span class="severity-label">病変部位数:</span>
                                <span class="severity-value" id="segmentCount">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Severity Legend -->
                <div class="severity-legend">
                    <h4>SES-CD 重症度判定基準</h4>
                    <div class="legend-items">
                        <div class="legend-item remission">
                            <span class="legend-color"></span>
                            <span class="legend-text">寛解（0-2）</span>
                        </div>
                        <div class="legend-item mild">
                            <span class="legend-color"></span>
                            <span class="legend-text">軽症（3-6）</span>
                        </div>
                        <div class="legend-item moderate">
                            <span class="legend-color"></span>
                            <span class="legend-text">中等症（7-15）</span>
                        </div>
                        <div class="legend-item severe">
                            <span class="legend-color"></span>
                            <span class="legend-text">重症（≥16）</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>© 2026 SES-CD / MM-SES-CD Calculator</p>
            <p class="disclaimer">このアプリは臨床判断の参考としてご利用ください。</p>
        </footer>
    </div>

    <!-- Floating Criteria Panel -->
    <div class="criteria-panel" id="criteriaPanel">
        <button class="criteria-toggle" id="criteriaToggle">
            <svg class="criteria-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                <polyline points="14 2 14 8 20 8" />
                <line x1="16" y1="13" x2="8" y2="13" />
                <line x1="16" y1="17" x2="8" y2="17" />
                <polyline points="10 9 9 9 8 9" />
            </svg>
            <span class="criteria-toggle-text">評価基準</span>
            <svg class="criteria-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="18 15 12 9 6 15" />
            </svg>
        </button>
        <div class="criteria-content" id="criteriaContent">
            <div class="criteria-header">
                <h3>SES-CD 評価項目の判定基準</h3>
            </div>
            <div class="criteria-tables">
                <!-- 潰瘍サイズ -->
                <div class="criteria-table">
                    <h4>潰瘍の有無とサイズ</h4>
                    <table>
                        <tbody>
                            <tr>
                                <td class="score-cell">0</td>
                                <td>潰瘍なし</td>
                            </tr>
                            <tr>
                                <td class="score-cell">1</td>
                                <td>アフタ性潰瘍（0.1〜0.5cm）</td>
                            </tr>
                            <tr>
                                <td class="score-cell">2</td>
                                <td>大きな潰瘍（0.5〜2cm）</td>
                            </tr>
                            <tr>
                                <td class="score-cell">3</td>
                                <td>非常に大きな潰瘍（＞2cm）</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- 潰瘍面積 -->
                <div class="criteria-table">
                    <h4>潰瘍面積</h4>
                    <table>
                        <tbody>
                            <tr>
                                <td class="score-cell">0</td>
                                <td>なし</td>
                            </tr>
                            <tr>
                                <td class="score-cell">1</td>
                                <td>＜10%</td>
                            </tr>
                            <tr>
                                <td class="score-cell">2</td>
                                <td>10〜30%</td>
                            </tr>
                            <tr>
                                <td class="score-cell">3</td>
                                <td>＞30%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- 病変面積 -->
                <div class="criteria-table">
                    <h4>病変面積</h4>
                    <table>
                        <tbody>
                            <tr>
                                <td class="score-cell">0</td>
                                <td>病変なし</td>
                            </tr>
                            <tr>
                                <td class="score-cell">1</td>
                                <td>＜50%</td>
                            </tr>
                            <tr>
                                <td class="score-cell">2</td>
                                <td>50〜75%</td>
                            </tr>
                            <tr>
                                <td class="score-cell">3</td>
                                <td>＞75%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- 狭窄 -->
                <div class="criteria-table">
                    <h4>狭窄の有無</h4>
                    <table>
                        <tbody>
                            <tr>
                                <td class="score-cell">0</td>
                                <td>なし</td>
                            </tr>
                            <tr>
                                <td class="score-cell">1</td>
                                <td>単発、通過可能</td>
                            </tr>
                            <tr>
                                <td class="score-cell">2</td>
                                <td>多発、通過可能</td>
                            </tr>
                            <tr>
                                <td class="score-cell">3</td>
                                <td>通過不能</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Voice Feedback Modal -->
    <div class="voice-modal" id="voiceModal">
        <div class="voice-modal-content">
            <div class="voice-animation">
                <div class="voice-ring"></div>
                <div class="voice-ring"></div>
                <div class="voice-ring"></div>
                <svg class="voice-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z" />
                    <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                    <line x1="12" x2="12" y1="19" y2="22" />
                </svg>
            </div>
            <p class="voice-segment" id="voiceSegment"></p>
            <p class="voice-prompt">スコアを話してください（0〜3）</p>

            <!-- 基準表示エリア -->
            <div class="voice-criteria" id="voiceCriteria">
                <div class="criteria-row"><span class="criteria-score">0</span><span class="criteria-desc"
                        id="criteriaDesc0">-</span></div>
                <div class="criteria-row"><span class="criteria-score">1</span><span class="criteria-desc"
                        id="criteriaDesc1">-</span></div>
                <div class="criteria-row"><span class="criteria-score">2</span><span class="criteria-desc"
                        id="criteriaDesc2">-</span></div>
                <div class="criteria-row"><span class="criteria-score">3</span><span class="criteria-desc"
                        id="criteriaDesc3">-</span></div>
            </div>

            <p class="voice-result" id="voiceResult"></p>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>